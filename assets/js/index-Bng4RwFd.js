import{g as H,u as ue,c as de,d as ie}from"./useFormValue-ClFFbkWO.js";import{j as J}from"./index-BUeeKSKh.js";import{l as pe}from"./lodash-BA5lSfMf.js";import{a8 as ce,D as me,P as Q,a9 as _e,g as fe,M as ve,z as ge,a as z,I as Y,N as Z,a4 as ye,a5 as xe,a3 as we,x as ee,y as te,K as ae,v as M,h as A,a6 as he,m as be,a1 as ke,a2 as Ce}from"./ant-design-vue-BWs4Yhsa.js";import{al as Ie,a9 as De,D as ne,k as Ue,X as Re,b as Se,d as Ke}from"./@ant-design-68FpZE7s.js";import{d as V,r as u,s as P,o as E,b as j,j as T,c as e,u as a,X as q,a8 as t,W as _,ah as X,a9 as $e,C as Oe,A as Ee,a7 as W,m as Te,t as Fe,F as Ne,h as b,a as G}from"./@vue-D377Yz3Q.js";import{T as qe}from"./index-B_BGuqt1.js";/* empty css                */import"./vue-i18n-DLwGe23y.js";import"./@intlify-DCihH9S3.js";import"./dayjs-CnD8zroB.js";import"./@amap-Cfb1MzxV.js";import"./pinia-B1Iyq0wd.js";import"./vue-demi-Dq6ymT-8.js";import"./@vueuse-BRxBMKk3.js";import"./pinia-plugin-persistedstate-RV7uh3T-.js";import"./axios-DsPaXkF5.js";import"./vue-router-CZk6BKTr.js";import"./nprogress-Dri_fBp5.js";import"./mockjs-Bm9OmztK.js";import"./@babel-BiFW4_mA.js";import"./lodash-es-BtLQVgmQ.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./@ctrl-DOFZgDuz.js";import"./throttle-debounce-CUWDS_la.js";import"./vue-types-C5fUfLeo.js";import"./dom-align-CRCehRfe.js";import"./async-validator-DKvM95Vc.js";import"./scroll-into-view-if-needed-SxpMpKWN.js";import"./compute-scroll-into-view-1gs_hJI2.js";import"./@emotion-BtrR-yrm.js";import"./stylis-DsJDcYJc.js";import"./Table-BpQGHwcW.js";import"./vue-draggable-plus-WlOHM_yN.js";const Me={class:"bg-[var(--common-bg-color)]"},Be={flex:"","items-center":"","p-3":""},Le={class:"p-3"},ze=V({__name:"DeptTree",emits:["change"],setup(U,{emit:g}){const l=g,h=u(""),c=()=>{w({name:h.value})},k=({key:y})=>{y==="expand"?o.value=i.value:y==="un-expand"&&(o.value=[])},C=u(!1),i=u([]),o=u([]),R=u([]),S=u([]),K=y=>{l("change",y[0])},w=async y=>{C.value=!0;const p=await H(y);S.value=J({list:p.data,orderFiled:"order"}),o.value=p.data.filter(x=>{var d;return(d=x==null?void 0:x.children)==null?void 0:d.length}).map(x=>x.id),i.value=pe.cloneDeep(o.value),C.value=!1};return P(()=>{w()}),(y,p)=>{const x=ce,d=Ie,n=fe,I=ve,f=me,v=Q,m=_e;return E(),j("div",Me,[T("div",Be,[e(x,{value:a(h),"onUpdate:value":p[0]||(p[0]=r=>q(h)?h.value=r:null),placeholder:"搜索部门","allow-clear":"",onSearch:c},null,8,["value"]),e(f,{trigger:"click"},{overlay:t(()=>[e(I,{onClick:k},{default:t(()=>[e(n,{key:"expand"},{default:t(()=>[_(" 展开全部 ")]),_:1}),e(n,{key:"un-expand"},{default:t(()=>[_(" 折叠全部 ")]),_:1})]),_:1})]),default:t(()=>[e(d,{style:{"font-size":"20px",cursor:"pointer"}})]),_:1})]),e(v,{style:{margin:"unset"}}),T("div",Le,[e(m,{expandedKeys:a(o),"onUpdate:expandedKeys":p[1]||(p[1]=r=>q(o)?o.value=r:null),selectedKeys:a(R),"onUpdate:selectedKeys":p[2]||(p[2]=r=>q(R)?R.value=r:null),"tree-data":a(S),fieldNames:{children:"children",title:"name",key:"id"},onSelect:K},null,8,["expandedKeys","selectedKeys","tree-data"])])])}}}),Ve={"text-end":""},Pe=V({__name:"SetUserDrawer",props:X({isEdit:{type:Boolean,default:!1},data:{type:Object,default:()=>({})}},{open:{type:Boolean,default:!1},openModifiers:{}}),emits:X(["reload"],["update:open"]),setup(U,{emit:g}){const l=U,h=g,c=$e(U,"open"),k=Oe(()=>l.isEdit?"编辑用户":"新增用户"),C=u([]),i=u(),{form:o,resetFormValue:R,setFormValue:S}=ue({username:"",nickname:"",deptId:null,phone:"",status:1,sex:1,email:"",role:null}),K=async()=>{await i.value.validate(),z.success("操作成功"),h("reload"),w()},w=()=>{R(),c.value=!1},y=async d=>{const n=await H(d);C.value=J({list:n.data,orderFiled:"order"})},p=u([]),x=async()=>{const d=await de();p.value=d.data};return Ee(()=>c.value,()=>{var d,n;c.value&&l.isEdit&&S({...l.data,deptId:((n=(d=l.data)==null?void 0:d.dept)==null?void 0:n.id)||null})}),P(()=>{y(),x()}),(d,n)=>{const I=Y,f=Z,v=ye,m=xe,r=we,B=ee,F=te,$=ae,O=M,L=ge;return E(),W(L,{open:c.value,"onUpdate:open":n[8]||(n[8]=s=>c.value=s),title:a(k),placement:"right",onClose:w},{footer:t(()=>[T("div",Ve,[e(O,{type:"primary",onClick:K},{default:t(()=>[_("确定")]),_:1}),e(O,{onClick:w},{default:t(()=>[_("取消")]),_:1})])]),default:t(()=>[e($,{ref_key:"formRef",ref:i,model:a(o),layout:"vertical"},{default:t(()=>[e(f,{label:"名称",name:"username",required:""},{default:t(()=>[e(I,{value:a(o).username,"onUpdate:value":n[0]||(n[0]=s=>a(o).username=s),placeholder:"请输入名称",allowClear:""},null,8,["value"])]),_:1}),e(f,{label:"昵称",name:"nickname",required:""},{default:t(()=>[e(I,{value:a(o).nickname,"onUpdate:value":n[1]||(n[1]=s=>a(o).nickname=s),placeholder:"请输入昵称",allowClear:""},null,8,["value"])]),_:1}),e(f,{label:"性别",name:"sex",required:""},{default:t(()=>[e(m,{value:a(o).sex,"onUpdate:value":n[2]||(n[2]=s=>a(o).sex=s),"button-style":"solid"},{default:t(()=>[e(v,{value:1},{default:t(()=>[_("男")]),_:1}),e(v,{value:0},{default:t(()=>[_("女")]),_:1})]),_:1},8,["value"])]),_:1}),e(f,{label:"部门",name:"deptId",required:""},{default:t(()=>[e(r,{value:a(o).deptId,"onUpdate:value":n[3]||(n[3]=s=>a(o).deptId=s),placeholder:"请选择部门","allow-clear":"","tree-data":a(C),"tree-default-expand-all":"","tree-node-filter-prop":"name","field-names":{children:"children",label:"name",value:"id"}},null,8,["value","tree-data"])]),_:1}),e(f,{label:"手机号码",name:"phone",required:""},{default:t(()=>[e(I,{value:a(o).phone,"onUpdate:value":n[4]||(n[4]=s=>a(o).phone=s),placeholder:"请输入手机号码",allowClear:""},null,8,["value"])]),_:1}),e(f,{label:"状态",name:"status",required:""},{default:t(()=>[e(m,{value:a(o).status,"onUpdate:value":n[5]||(n[5]=s=>a(o).status=s),"button-style":"solid"},{default:t(()=>[e(v,{value:1},{default:t(()=>[_("启用")]),_:1}),e(v,{value:0},{default:t(()=>[_("停用")]),_:1})]),_:1},8,["value"])]),_:1}),e(f,{label:"邮箱",name:"email",required:""},{default:t(()=>[e(I,{value:a(o).email,"onUpdate:value":n[6]||(n[6]=s=>a(o).email=s),placeholder:"请输入邮箱",allowClear:""},null,8,["value"])]),_:1}),e(f,{label:"角色",name:"role",required:""},{default:t(()=>[e(F,{value:a(o).role,"onUpdate:value":n[7]||(n[7]=s=>a(o).role=s),placeholder:"请选择角色",allowClear:""},{default:t(()=>[(E(!0),j(Ne,null,Te(a(p),s=>(E(),W(B,{key:s.id,value:s.roleCode},{default:t(()=>[_(Fe(s.roleName),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title"])}}}),je=(U,g)=>[{title:"序号",dataIndex:"index",align:"center",width:60,fixed:"left",customRender:({index:l})=>l+1},{title:"名称",align:"center",dataIndex:"username"},{title:"昵称",align:"center",dataIndex:"nickname"},{title:"性别",align:"center",customRender:({record:l})=>b(A,{color:l.sex===1?"green":"red"},()=>l.sex===1?"男":"女")},{title:"部门",align:"center",customRender:({record:l})=>l.dept.name},{title:"手机号码",align:"center",dataIndex:"phone"},{title:"状态",align:"center",dataIndex:"status",customRender:({record:l})=>b(A,{color:l.status===1?"green":"red"},()=>l.status===1?"启用":"停用")},{title:"创建时间",align:"center",dataIndex:"createTime"},{title:"操作",dataIndex:"action",align:"center",width:120,customRender:({record:l})=>b("div",{},[b(M,{type:"link",icon:b(De),onClick:()=>U(l)}),b(Q,{type:"vertical"}),b(he,{title:"确定删除吗？",overlayStyle:{width:"200px"},onConfirm:()=>g(l)},()=>b(M,{type:"link",danger:!0,icon:b(ne)}))])}],Ae={class:"w-full min-h-full flex gap-3"},Xe={class:"w-4/5"},We={class:"rounded-1.5 bg-[var(--common-bg-color)] p-4"},Rt=V({__name:"index",setup(U){const g=u(!1),l=u(!1),h=u(),c=G({username:"",status:null}),k=u(!1),C=u(),i=G({pageSize:10,pageNum:1,total:0}),S=je(m=>{k.value=!0,C.value=m,g.value=!0},m=>{z.success("假装删除成功："+m.username),v()}),K=u(),w=u(""),y=m=>{w.value=m,v({...c,dept:w.value,...i})},p=()=>{h.value.resetFields(),d.value=[],i.pageNum=1,i.pageSize=10,i.total=0,v(i)},x=async()=>{v({...c,dept:w.value,...i})},d=u([]),n=u({fixed:!0,selectedRowKeys:d,onChange:m=>{d.value=m}}),I=()=>{k.value=!1,g.value=!0},f=()=>{be.confirm({title:"提示",icon:e(Ue),content:"请问确认批量删除吗？",closable:!0,onOk(){return Promise.resolve().then(()=>{z.success("假装删除成功"),p()})}})},v=async m=>{l.value=!0;const r=await ie(m);K.value=r.data.rows,i.total=r.data.total,l.value=!1};return P(()=>{v()}),(m,r)=>{const B=Y,F=Z,$=ke,O=ee,L=te,s=Re,N=M,oe=Se,le=Ce,se=ae,re=Ke;return E(),j("div",Ae,[e(ze,{class:"w-1/5",onChange:y}),T("div",Xe,[T("div",We,[e(se,{class:"search-form",ref_key:"formRef",ref:h,"label-col":{span:6},model:a(c)},{default:t(()=>[e(le,{gutter:36},{default:t(()=>[e($,{span:8},{default:t(()=>[e(F,{label:"用户名称",name:"username"},{default:t(()=>[e(B,{value:a(c).username,"onUpdate:value":r[0]||(r[0]=D=>a(c).username=D),placeholder:"请输入",allowClear:""},null,8,["value"])]),_:1})]),_:1}),e($,{span:8},{default:t(()=>[e(F,{label:"状态",name:"status"},{default:t(()=>[e(L,{value:a(c).status,"onUpdate:value":r[1]||(r[1]=D=>a(c).status=D),placeholder:"请选择",allowClear:""},{default:t(()=>[e(O,{value:0},{default:t(()=>[_("停用")]),_:1}),e(O,{value:1},{default:t(()=>[_("启用")]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),e($,{span:8,"text-end":""},{default:t(()=>[e(N,{onClick:p},{icon:t(()=>[e(s)]),default:t(()=>[_(" 重置 ")]),_:1}),e(N,{type:"primary",ghost:"",onClick:x},{icon:t(()=>[e(oe)]),default:t(()=>[_(" 查询 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),e(a(qe),{class:"mt-3",columns:a(S),"data-source":a(K),bordered:"",title:"用户管理",rowKey:"id",loading:a(l),pagination:{current:a(i).pageNum,pageSize:a(i).pageSize,total:a(i).total,showTotal:D=>`共 ${D} 条`},"row-selection":a(n),onReload:p},{"pre-tools":t(()=>[e(N,{type:"primary",onClick:I},{icon:t(()=>[e(re)]),default:t(()=>[_(" 新增 ")]),_:1}),e(N,{ghost:"",danger:"",disabled:!a(d).length,onClick:f},{icon:t(()=>[e(a(ne))]),default:t(()=>[_(" 批量删除 ")]),_:1},8,["disabled"])]),_:1},8,["columns","data-source","loading","pagination","row-selection"])]),e(Pe,{open:a(g),"onUpdate:open":r[2]||(r[2]=D=>q(g)?g.value=D:null),data:a(C),isEdit:a(k),onReload:r[3]||(r[3]=D=>k.value=!1)},null,8,["open","data","isEdit"])])}}});export{Rt as default};

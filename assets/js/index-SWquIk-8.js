import{h as Z}from"./index-BbXLtVbP.js";import{u as ee,a as te,b as ae}from"./useFormValue-D3bN2swK.js";import{T as oe}from"./index-DdZDXnai.js";import{a3 as K,a as V,I as q,N as A,i as L,a4 as ne,a5 as le,Y as se,K as W,M as re,v as z,P as ue,a6 as ie,a1 as pe,x as de,y as me,a2 as _e}from"./ant-design-vue-0a5K7RUJ.js";import{d as X,ah as $,a9 as ce,C as fe,r as _,A as ve,s as j,o as H,a7 as Y,a8 as t,c as e,u as a,W as c,t as B,h as f,a as F,X as P}from"./@vue-D377Yz3Q.js";import{a9 as ge,D as ye,X as we,b as be,d as ke}from"./@ant-design-68FpZE7s.js";/* empty css                */import"./vue-i18n-DLwGe23y.js";import"./@intlify-DCihH9S3.js";import"./lodash-BA5lSfMf.js";import"./@amap-Cfb1MzxV.js";import"./dayjs-CnD8zroB.js";import"./pinia-B1Iyq0wd.js";import"./vue-demi-Dq6ymT-8.js";import"./@vueuse-BRxBMKk3.js";import"./pinia-plugin-persistedstate-RV7uh3T-.js";import"./axios-DsPaXkF5.js";import"./vue-router-CZk6BKTr.js";import"./nprogress-Dri_fBp5.js";import"./mockjs-Bm9OmztK.js";import"./@babel-BiFW4_mA.js";import"./lodash-es-BtLQVgmQ.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./@ctrl-DOFZgDuz.js";import"./throttle-debounce-CUWDS_la.js";import"./vue-types-C5fUfLeo.js";import"./dom-align-CRCehRfe.js";import"./async-validator-DKvM95Vc.js";import"./scroll-into-view-if-needed-SxpMpKWN.js";import"./compute-scroll-into-view-1gs_hJI2.js";import"./@emotion-BtrR-yrm.js";import"./stylis-DsJDcYJc.js";import"./Table-DyZMArVX.js";import"./vue-draggable-plus-WlOHM_yN.js";const xe=X({__name:"SetRoleModal",props:$({isEdit:{type:Boolean,default:!1},data:{type:Object,default:()=>({})}},{open:{type:Boolean},openModifiers:{}}),emits:$(["reload"],["update:open"]),setup(y,{emit:d}){const s=y,r=ce(y,"open"),k=fe(()=>s.isEdit?"编辑角色":"新增角色"),x=d,g=_(),{form:n,resetFormValue:C,setFormValue:p}=ee({roleName:"",roleCode:"",remark:"",menus:[],status:0}),S=_([]),D=async()=>{await g.value.validate(),V.success("操作成功"),x("reload"),R()},R=()=>{C(),r.value=!1},I=async()=>{const N=await te();S.value=N.data};return ve(()=>r.value,()=>{r.value&&s.isEdit&&p(s.data)}),j(()=>{I()}),(N,l)=>{const v=q,u=A,i=L,O=K,w=ne,b=le,h=se,U=W,M=re;return H(),Y(M,{open:r.value,"onUpdate:open":l[5]||(l[5]=o=>r.value=o),title:a(k),width:"550px",destroyOnClose:"",onOk:D,onCancel:R},{default:t(()=>[e(U,{class:"my-6",ref_key:"formRef",ref:g,model:a(n),layout:"horizontal","label-col":{span:4}},{default:t(()=>[e(u,{label:"角色名称",name:"roleName",required:""},{default:t(()=>[e(v,{value:a(n).roleName,"onUpdate:value":l[0]||(l[0]=o=>a(n).roleName=o),placeholder:"请输入角色名称",allowClear:""},null,8,["value"])]),_:1}),e(u,{label:"角色标识",name:"roleCode",required:""},{default:t(()=>[e(v,{value:a(n).roleCode,"onUpdate:value":l[1]||(l[1]=o=>a(n).roleCode=o),placeholder:"请输入角色标识",allowClear:""},null,8,["value"])]),_:1}),e(u,{label:"菜单分配",name:"menus",required:""},{default:t(()=>[e(O,{value:a(n).menus,"onUpdate:value":l[2]||(l[2]=o=>a(n).menus=o),placeholder:"请选择菜单","allow-clear":"","tree-data":a(S),"tree-node-filter-prop":"title","tree-checkable":"",showCheckedStrategy:a(K).SHOW_PARENT,"field-names":{children:"children",label:"title",value:"id"}},{title:t(({title:o})=>[c(B(o),1)]),tagRender:t(({label:o,closable:E,onClose:T})=>[e(i,{closable:E,color:"blue",onClose:T},{default:t(()=>[c(B(o)+"   ",1)]),_:2},1032,["closable","onClose"])]),_:1},8,["value","tree-data","showCheckedStrategy"])]),_:1}),e(u,{label:"状态",name:"status",required:""},{default:t(()=>[e(b,{value:a(n).status,"onUpdate:value":l[3]||(l[3]=o=>a(n).status=o),"button-style":"solid"},{default:t(()=>[e(w,{value:1},{default:t(()=>[c("启用")]),_:1}),e(w,{value:0},{default:t(()=>[c("停用")]),_:1})]),_:1},8,["value"])]),_:1}),e(u,{label:"备注",name:"remark"},{default:t(()=>[e(h,{value:a(n).remark,"onUpdate:value":l[4]||(l[4]=o=>a(n).remark=o),placeholder:"请输入备注","auto-size":{minRows:3,maxRows:5}},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title"])}}}),Ce=(y,d)=>[{title:"角色名称",dataIndex:"roleName"},{title:"角色标识",dataIndex:"roleCode",align:"center",width:150},{title:"状态",dataIndex:"status",align:"center",width:80,customRender:({text:s})=>f(L,{color:s?"green":"red"},()=>s?"启用":"停用")},{title:"创建时间",dataIndex:"createTime",align:"center"},{title:"备注",dataIndex:"remark",align:"center",width:600},{title:"操作",dataIndex:"action",align:"center",width:120,customRender:({record:s})=>f("div",{},[f(z,{type:"link",icon:f(ge),onClick:()=>y(s)}),f(ue,{type:"vertical"}),f(ie,{title:"确定删除吗？",overlayStyle:{width:"200px"},onConfirm:()=>d(s)},()=>f(z,{type:"link",danger:!0,icon:f(ye)}))])}],nt=X({__name:"index",setup(y){const d=_(!1),s=_(!1),r=F({roleName:"",status:null}),k=_(),x=_(),g=_([]),n=_(!1),C=_([]),p=F({pageSize:10,pageNum:1,total:0}),R=Ce(u=>{d.value=!0,s.value=!0,x.value=u},u=>{V.success("假装删除成功："+u.name),v()}),I=()=>{s.value=!1,d.value=!0},N=async()=>{v({...r,...p})},l=()=>{k.value.resetFields(),p.pageNum=1,p.pageSize=10,p.total=0,v(p)},v=async u=>{n.value=!0;const i=await ae(u);C.value=i.data.rows,n.value=!1};return j(()=>{v()}),(u,i)=>{const O=q,w=A,b=pe,h=de,U=me,M=we,o=z,E=be,T=_e,G=W,J=ke,Q=Z;return H(),Y(Q,{dense:""},{header:t(()=>[e(G,{class:"search-form",ref_key:"formRef",ref:k,"label-col":{span:6},model:a(r)},{default:t(()=>[e(T,{gutter:36},{default:t(()=>[e(b,{span:8},{default:t(()=>[e(w,{label:"角色名称",name:"roleName"},{default:t(()=>[e(O,{value:a(r).roleName,"onUpdate:value":i[0]||(i[0]=m=>a(r).roleName=m),placeholder:"请输入"},null,8,["value"])]),_:1})]),_:1}),e(b,{span:8},{default:t(()=>[e(w,{label:"状态",name:"status"},{default:t(()=>[e(U,{value:a(r).status,"onUpdate:value":i[1]||(i[1]=m=>a(r).status=m),placeholder:"请选择"},{default:t(()=>[e(h,{value:0},{default:t(()=>[c("停用")]),_:1}),e(h,{value:1},{default:t(()=>[c("启用")]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),e(b,{span:8,"text-end":""},{default:t(()=>[e(o,{onClick:l},{icon:t(()=>[e(M)]),default:t(()=>[c(" 重置 ")]),_:1}),e(o,{type:"primary",ghost:"",onClick:N},{icon:t(()=>[e(E)]),default:t(()=>[c(" 查询 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),default:t(()=>[e(a(oe),{columns:a(R),"data-source":a(C),bordered:"",title:"角色管理",rowKey:"id",loading:a(n),sticky:"",expandedRowKeys:a(g),"onUpdate:expandedRowKeys":i[2]||(i[2]=m=>P(g)?g.value=m:null),pagination:{current:a(p).pageNum,pageSize:a(p).pageSize,total:a(p).total,showTotal:m=>`共 ${m} 条`},onReload:l},{"pre-tools":t(()=>[e(o,{type:"primary",onClick:I},{icon:t(()=>[e(J)]),default:t(()=>[c(" 新增 ")]),_:1})]),_:1},8,["columns","data-source","loading","expandedRowKeys","pagination"]),e(xe,{open:a(d),"onUpdate:open":i[3]||(i[3]=m=>P(d)?d.value=m:null),isEdit:a(s),data:a(x)},null,8,["open","isEdit","data"])]),_:1})}}});export{nt as default};

import{j as z,h as Y}from"./index-z8k7jd6L.js";import{u as G,g as H}from"./useFormValue-DspM2tN5.js";import{T as J}from"./index-D2BCVQSK.js";import{a as K,I as S,N as V,a3 as Q,w as Z,a4 as ee,a5 as te,Y as ae,K as $,v as h,z as ne,h as oe,P as le,a6 as re,a1 as se,x as ue,y as ie,a2 as de}from"./ant-design-vue-BWs4Yhsa.js";import{d as M,ah as q,a9 as pe,C as me,r as f,A as _e,o as N,a7 as P,a8 as t,j as ce,c as e,W as d,u as a,h as c,a as fe,s as ve,X as F}from"./@vue-D377Yz3Q.js";import{a9 as ge,D as ye,X as xe,b as we,d as be}from"./@ant-design-68FpZE7s.js";/* empty css                */import"./vue-i18n-DLwGe23y.js";import"./@intlify-DCihH9S3.js";import"./lodash-BA5lSfMf.js";import"./@amap-Cfb1MzxV.js";import"./dayjs-CnD8zroB.js";import"./pinia-B1Iyq0wd.js";import"./vue-demi-Dq6ymT-8.js";import"./@vueuse-BRxBMKk3.js";import"./pinia-plugin-persistedstate-RV7uh3T-.js";import"./axios-DsPaXkF5.js";import"./vue-router-CZk6BKTr.js";import"./nprogress-Dri_fBp5.js";import"./mockjs-Bm9OmztK.js";import"./@babel-BiFW4_mA.js";import"./lodash-es-BtLQVgmQ.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./@ctrl-DOFZgDuz.js";import"./throttle-debounce-CUWDS_la.js";import"./vue-types-C5fUfLeo.js";import"./dom-align-CRCehRfe.js";import"./async-validator-DKvM95Vc.js";import"./scroll-into-view-if-needed-SxpMpKWN.js";import"./compute-scroll-into-view-1gs_hJI2.js";import"./@emotion-BtrR-yrm.js";import"./stylis-DsJDcYJc.js";import"./Table-DjhB8FbE.js";import"./vue-draggable-plus-WlOHM_yN.js";const ke={"text-end":""},Ie=M({__name:"SetDeptDrawer",props:q({data:{type:Object,default:()=>({})},treeData:{type:Array,default:()=>[]},isEdit:{type:Boolean,default:!1}},{open:{type:Boolean,default:!1},openModifiers:{}}),emits:q(["reload"],["update:open"]),setup(v,{emit:i}){const r=v,p=i,m=pe(v,"open"),R=me(()=>r.isEdit?"编辑部门":"新增部门"),g=f(),{form:n,resetFormValue:b,setFormValue:B}=G({name:"",parentId:null,order:0,principal:"",status:1,remark:""}),O=async()=>{await g.value.validate(),K.success("操作成功"),p("reload"),k()},k=()=>{b(),m.value=!1};return _e(()=>m.value,()=>{m.value&&r.isEdit&&B(r.data)}),(T,l)=>{const I=S,s=V,_=Q,u=Z,y=ee,x=te,C=ae,U=$,D=h,E=ne;return N(),P(E,{open:m.value,"onUpdate:open":l[6]||(l[6]=o=>m.value=o),title:a(R),placement:"right",onClose:k},{footer:t(()=>[ce("div",ke,[e(D,{type:"primary",onClick:O},{default:t(()=>[d("确定")]),_:1}),e(D,{onClick:k},{default:t(()=>[d("取消")]),_:1})])]),default:t(()=>[e(U,{ref_key:"formRef",ref:g,model:a(n),layout:"vertical"},{default:t(()=>[e(s,{label:"部门名称",name:"name",required:""},{default:t(()=>[e(I,{value:a(n).name,"onUpdate:value":l[0]||(l[0]=o=>a(n).name=o),placeholder:"请输入部门名称",allowClear:""},null,8,["value"])]),_:1}),e(s,{label:"上级部门",name:"parentId",required:!v.isEdit||!!a(n).parentId},{default:t(()=>[e(_,{value:a(n).parentId,"onUpdate:value":l[1]||(l[1]=o=>a(n).parentId=o),placeholder:"请选择上级部门","allow-clear":"","tree-data":v.treeData,"tree-default-expand-all":"","tree-node-filter-prop":"name","field-names":{children:"children",label:"name",value:"id"}},null,8,["value","tree-data"])]),_:1},8,["required"]),e(s,{label:"负责人",name:"principal",required:""},{default:t(()=>[e(I,{value:a(n).principal,"onUpdate:value":l[2]||(l[2]=o=>a(n).principal=o),placeholder:"请输入负责人",allowClear:""},null,8,["value"])]),_:1}),e(s,{label:"排序",name:"order",required:""},{default:t(()=>[e(u,{value:a(n).order,"onUpdate:value":l[3]||(l[3]=o=>a(n).order=o),min:1},null,8,["value"])]),_:1}),e(s,{label:"状态",name:"status",required:""},{default:t(()=>[e(x,{value:a(n).status,"onUpdate:value":l[4]||(l[4]=o=>a(n).status=o),"button-style":"solid"},{default:t(()=>[e(y,{value:1},{default:t(()=>[d("启用")]),_:1}),e(y,{value:0},{default:t(()=>[d("停用")]),_:1})]),_:1},8,["value"])]),_:1}),e(s,{label:"备注",name:"remark"},{default:t(()=>[e(C,{value:a(n).remark,"onUpdate:value":l[5]||(l[5]=o=>a(n).remark=o),placeholder:"请输入备注",allowClear:""},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title"])}}}),Ce=(v,i)=>[{title:"部门名称",dataIndex:"name",fixed:"left"},{title:"排序",dataIndex:"order",align:"center",width:80},{title:"状态",dataIndex:"status",align:"center",customRender:({text:r})=>c(oe,{color:r?"green":"red"},()=>r?"启用":"停用")},{title:"创建时间",dataIndex:"createTime",align:"center"},{title:"备注",dataIndex:"remark",align:"center",width:600},{title:"操作",dataIndex:"action",align:"center",width:120,fixed:"right",customRender:({record:r})=>c("div",{},[c(h,{type:"link",icon:c(ge),onClick:()=>v(r)}),c(le,{type:"vertical"}),c(re,{title:"确定删除吗？",overlayStyle:{width:"200px"},onConfirm:()=>i(r)},()=>c(h,{type:"link",danger:!0,icon:c(ye)}))])}],lt=M({__name:"index",setup(v){const i=f(!1),r=f(!1),p=fe({name:"",status:null}),m=f(),R=f(),g=f([]),n=f(!1),b=f([]),k=Ce(_=>{i.value=!0,r.value=!0,R.value=_},_=>{K.success("假装删除成功："+_.name),s()}),T=()=>{r.value=!1,i.value=!0},l=async()=>{s(p)},I=()=>{m.value.resetFields(),s()},s=async _=>{var y,x;n.value=!0;const u=await H(_);b.value=z({list:u.data,orderFiled:"order"}),g.value.push((x=(y=b.value)==null?void 0:y[0])==null?void 0:x.id),n.value=!1};return ve(()=>{s()}),(_,u)=>{const y=S,x=V,C=se,U=ue,D=ie,E=xe,o=h,j=we,A=de,L=$,W=be,X=Y;return N(),P(X,{dense:""},{header:t(()=>[e(L,{class:"search-form",ref_key:"formRef",ref:m,"label-col":{span:6},model:a(p)},{default:t(()=>[e(A,{gutter:36},{default:t(()=>[e(C,{span:8},{default:t(()=>[e(x,{label:"部门名称",name:"name"},{default:t(()=>[e(y,{value:a(p).name,"onUpdate:value":u[0]||(u[0]=w=>a(p).name=w),placeholder:"请输入"},null,8,["value"])]),_:1})]),_:1}),e(C,{span:8},{default:t(()=>[e(x,{label:"状态",name:"status"},{default:t(()=>[e(D,{value:a(p).status,"onUpdate:value":u[1]||(u[1]=w=>a(p).status=w),placeholder:"请选择"},{default:t(()=>[e(U,{value:0},{default:t(()=>[d("停用")]),_:1}),e(U,{value:1},{default:t(()=>[d("启用")]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),e(C,{span:8,"text-end":""},{default:t(()=>[e(o,{onClick:I},{icon:t(()=>[e(E)]),default:t(()=>[d(" 重置 ")]),_:1}),e(o,{type:"primary",ghost:"",onClick:l},{icon:t(()=>[e(j)]),default:t(()=>[d(" 查询 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),default:t(()=>[e(a(J),{columns:a(k),"data-source":a(b),bordered:"",title:"部门管理",rowKey:"id",loading:a(n),scroll:{x:1300},sticky:"",pagination:!1,expandedRowKeys:a(g),"onUpdate:expandedRowKeys":u[2]||(u[2]=w=>F(g)?g.value=w:null),onReload:I},{"pre-tools":t(()=>[e(o,{type:"primary",onClick:T},{icon:t(()=>[e(W)]),default:t(()=>[d(" 新增 ")]),_:1})]),_:1},8,["columns","data-source","loading","expandedRowKeys"]),e(Ie,{open:a(i),"onUpdate:open":u[3]||(u[3]=w=>F(i)?i.value=w:null),isEdit:a(r),data:a(R),treeData:a(b),onReload:s},null,8,["open","isEdit","data","treeData"])]),_:1})}}});export{lt as default};
